"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const f=require("vue"),n=f.ref({}),v=1e3*60*60*24,w=()=>{const e=localStorage.getItem("icon_cache");if(e)try{n.value=JSON.parse(e)}catch{console.warn("[iconCache] localStorage 解析失败")}},b=()=>{localStorage.setItem("icon_cache",JSON.stringify(n.value))},g=e=>Date.now()-e.timestamp>=e.ttl,h=async(e,c,a,t=v)=>{const o=n.value[e]||{},s=o[c];if(s&&!g(s))return s.url;const r=await(await fetch(a)).blob(),u=URL.createObjectURL(r);return n.value[e]={...o,[c]:{url:u,timestamp:Date.now(),ttl:t}},b(),u},d=async(e,c)=>{const a=c.map(t=>h(e,t.key,t.url,t.ttl));return Promise.all(a)},m=async()=>{const e=Date.now();for(const c in n.value){const a=n.value[c];for(const t in a){const o=a[t];if(g(o))try{debugger;const i=await(await fetch(o.url)).blob(),r=URL.createObjectURL(i);URL.revokeObjectURL(o.url),o.url=r,o.timestamp=e}catch{console.warn(`[iconCache] 刷新失败: ${c}/${t}`)}}}b()};w();const l={icons:n,getIcon:h,preloadIcons:d,autoRefresh:m},p={install(e){e.config.globalProperties.$icon=l,e.provide("$icon",l)}};exports.$icon=l;exports.default=p;
