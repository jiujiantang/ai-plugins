!function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}System.register([],function(t,n){"use strict";return{execute:function(){window._lib_pay=function(){function t(e){return""===e?"":"/"===e.slice(0,1)?e:"/"+e}function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return-1!==window.location.origin.indexOf("localhost")||-1!==window.location.origin.indexOf("dybzp")?"http://localhost.3d66.com:8888"+t(e):-1!==window.location.origin.indexOf("dev")?"http://service.dev.3d66.com"+t(e):-1!==window.location.origin.indexOf("test")||-1!==window.location.origin.indexOf("dybzp")?"https://service_test.3d66.com"+t(e):"https://service.3d66.com"+t(e)}var o=null;function a(e,t){var n=navigator.userAgent.toLowerCase();n.indexOf("msie")>-1&&n.match(/msie ([\d.]+)/)[1];var o=$("#_qrcode");switch(t){case"ali":o.html(""),e.unionPay?setTimeout(function(){o.qrcode({width:120,height:120,text:e.qrcode})},100):document.getElementById("iframeid")||o.append('<iframe id="iframeid" src="'.concat(e.payurl,'" width="120" height="120" frameborder="0" scrolling="no"></iframe>'));break;case"wechat":o.html(""),o.qrcode({width:120,height:120,text:e})}}var i=i||{};return i.getVersionId=function(){var e=0;try{e=window.external.LiuYunKuVersionId}catch(t){console.log("获取失败："+t)}return Number(e)},i.paymentSuccessCallback=function(t){var n={handler:"object"==e(window.external)?window.external:{},paymentSuccessCallback:function(e){var t,n=!1;try{e=void 0!==e?e:"",this.handler.paymentSuccessCallback(e)}catch(o){n=!0,t=o}return new Promise(function(e,o){n?o(t):e()})}};n.paymentSuccessCallback(t).catch(function(e){console.log("方法调用失败："+e)})},i.refAccountCallback=function(){try{"object"==e(window.external)&&window.external;window.external.refAccountCallback()}catch(t){console.log("方法调用失败")}},{paymentFcun:function(e,t){$("#_qrcode").html(""),$(".pop_pay .ref .past").text("").addClass("loading").show();var r=JSON.stringify(e);$.ajax({url:n("/payment/do_payment"),type:"post",data:{data:r},xhrFields:{withCredentials:!0},success:function(r){if(1===r.status){switch(parseInt(e.cz_type)){case 0:a(r.data.qrcode,"wechat");break;case 1:a(r.data,"ali");break;case 3:$("#_paypalSubmit").html(r.data.payurl);break;default:$("#_qrcode").empty(),a(r.data.qrcode,"wechat")}!function(e,t,a,r){clearInterval(o),o=setInterval(function(){$(".pop_pay").is(":visible")||clearInterval(o),$.ajax({url:n("/pay/check_pay"),type:"post",data:{service:"ll.order.check",jkma:e,cz_channel:t},xhrFields:{withCredentials:!0},success:function(e){if(200===e.status){a(),clearInterval(o);var t=window.location.origin.indexOf("test")>-1?660:1409;i.getVersionId()>t?i.paymentSuccessCallback(e.data):i.refAccountCallback()}else 401===e.status&&3!==r&&($(".pop_pay .ref .past").html('<p style="width: 100%;position: absolute;top: 50%;left: 50%;transform: translate(-50%, -50%);line-height: 20px; cursor: pointer" id="_userDefine_cover">二维码已失效<br>点击刷新</p>').show(),$("#_userDefine_cover").one("click",function(){$("#_payBtn li.active").trigger("click")}),clearInterval(o))},error:function(e){console.log("err:",e)}})},2e3)}(r.data.jkma,e.order_type,t,parseInt(e.cz_type)),$(".pop_pay .ref .past").removeClass("loading").hide()}else window.easyPop.open({type:"toast",content:r.msg}),$(".pop_pay .ref .past").removeClass("loading").html('<p style="width: 100%;position: absolute;top: 50%;left: 50%;transform: translate(-50%, -50%);line-height: 20px; cursor: pointer" id="_userDefine_cover">二维码已失效<br>点击刷新</p>').show(),$("#_userDefine_cover").one("click",function(){$("#_payBtn li.active").trigger("click")})}})},clearTabCheckPay:function(){$(".pop_pay .ref .past").hide(),clearInterval(o)}}}()}}})}();
//# sourceMappingURL=Pay-legacy-cbLIaXEj.js.map
